
@if (editForm?.dirty) {
<div class="alert alert-warning" role="alert">
  <p><strong>Information:</strong>
    you made changes to your profile, any unsaved changes will be lost
  </p>
</div>
}
<div *ngIf="member" class="container-fluid p-0">
  <div class="header-section position-relative">
    <div class="background-gradient"></div>
    <div class="container">
      <div class="row align-items-center pt-5 pb-4">
        <div class="">
          <div class="profile-card d-flex align-items-center animate__animated animate__fadeInUp">
            <div class="profile-image-container me-4">
              <img [src]="member.photoUrl || 'assets/images/default-avatar.jpg'" [alt]="member.knownAs"
                class="profile-image animate__animated animate__zoomIn">
            </div>

            <div class="profile-info text-white">
              <div>
                <h1 class="profile-name mb-2 animate__animated animate__fadeInLeft animate__delay-1s">
                  Edit Profile
                </h1>
                <p class="profile-title mb-1 animate__animated animate__fadeInLeft animate__delay-2s">
                  Update your information
                </p>
                <p class="profile-location mb-3 animate__animated animate__fadeInLeft animate__delay-2s">
                  <i class="fas fa-edit me-2"></i>
                  Make changes to your profile
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="container">
    <nav class="content-nav">
      <ul class="nav nav-tabs border-0 animate__animated animate__fadeInUp animate__delay-1s">
        <li class="nav-item">
          <a class="nav-link active" href="#basic-info" data-bs-toggle="tab" (click)="setActiveTab('basic-info')">
            <i class="fas fa-user me-2"></i>Basic Info
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#about" data-bs-toggle="tab"  (click)="setActiveTab('about')">
            <i class="fas fa-info-circle me-2"></i>About
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#interests" data-bs-toggle="tab" (click)="setActiveTab('interests')">
            <i class="fas fa-heart me-2"></i>Interests
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#photos" data-bs-toggle="tab" (click)="setActiveTab('photos')">
            <i class="fas fa-images me-2"></i>Photos
            <span class="badge bg-light text-dark ms-2">{{ member.photos.length || 0 }}</span>
          </a>
        </li>
      </ul>
    </nav>
  </div>

  <div class="container mt-4 mb-5 pb-3">
    <form #editForm="ngForm" (ngSubmit)="updateMember()">
      <div class="tab-content">
        <div class="tab-pane fade show active" id="basic-info">
          <div class="row">
            <div class="col-lg-8">
              <div class="card shadow-sm border-0 animate__animated animate__fadeInLeft">
                <div class="card-body p-4">
                  <h5 class="card-title mb-4">
                    <i class="fas fa-user-edit me-2 text-primary"></i>Basic Information
                  </h5>

                  <div class="row">
                    <div class="col-md-6 mb-3">
                      <label for="knownAs" class="form-label">Display Name</label>
                      <input type="text" class="form-control" id="knownAs" [(ngModel)]="member.knownAs" name="knownAs"
                        placeholder="Enter your display name" required>
                    </div>
                    <div class="col-md-6 mb-3">
                      <label for="dateofbirth" class="form-label">Date of Birth</label>
                      <input type="date" class="form-control" id="dateofbirth" [(ngModel)]="member.dateOfBirth"
                        #dateInput="ngModel" name="dateofbirth" (blur)="onDateOfBirthChange(dateInput.value)">
                    </div>
                  </div>

                  <div class="row">
                    <div class="col-md-6 mb-3">
                      <label for="city" class="form-label">City</label>
                      <input type="text" class="form-control" id="city" [(ngModel)]="member.city" name="city"
                        placeholder="Enter your city" required>
                    </div>
                    <div class="col-md-6 mb-3">
                      <label for="country" class="form-label">Country</label>
                      <input type="text" class="form-control" id="country" [(ngModel)]="member.country" name="country"
                        placeholder="Enter your country" required>
                    </div>
                  </div>

                  <div class="mb-3">
                    <label for="gender" class="form-label">Gender</label>
                    <select class="form-select" id="gender" [(ngModel)]="member.gender" name="gender" required>
                      <option value="">Select Gender</option>
                      <option value="male">Male</option>
                      <option value="female">Female</option>
                    </select>
                  </div>
                </div>
              </div>
            </div>

            <div class="col-lg-4">
              <div class="card shadow-sm border-0 animate__animated animate__fadeInRight">
                <div class="card-body p-4">
                  <h5 class="card-title mb-3">
                    <i class="fas fa-info-circle me-2 text-primary"></i>Profile Stats
                  </h5>
                  <div class="detail-item mb-3">
                    <strong>Username:</strong>
                    <span class="text-muted ms-2">{{ member.userName }}</span>
                  </div>
                  <div class="detail-item mb-3">
                    <strong>Age:</strong>
                    <input style="background-color: white;width:50px" class="ms-2 border-0" [(ngModel)]="member.age"
                      name="age" disabled="true" />
                  </div>
                  <div class="detail-item mb-3">
                    <strong>Member Since:</strong>
                    <span class="text-muted ms-2">{{ member.created | date:'MMM yyyy' }}</span>
                  </div>
                  <div class="detail-item">
                    <strong>Last Active:</strong>
                    <span class="text-muted ms-2">{{ member.lastActive | date:'MMM d, yyyy' }}</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="tab-pane fade" id="about">
          <div class="card shadow-sm border-0 animate__animated animate__fadeInUp">
            <div class="card-body p-4">
              <h5 class="card-title mb-4">
                <i class="fas fa-edit me-2 text-primary"></i>About You
              </h5>

              <div class="mb-4">
                <label for="introduction" class="form-label">Introduction</label>
                <textarea class="form-control" id="introduction" rows="4" [(ngModel)]="member.introduction"
                  name="introduction" placeholder="Tell us about yourself..."></textarea>
                <div class="form-text">Share a brief introduction about yourself</div>
              </div>

              <div class="mb-4">
                <label for="lookingFor" class="form-label">Looking For</label>
                <textarea class="form-control" id="lookingFor" rows="3" [(ngModel)]="member.lookingFor"
                  name="lookingFor" placeholder="What are you looking for?"></textarea>
                <div class="form-text">Describe what you're looking for in connections</div>
              </div>
            </div>
          </div>
        </div>

        <div class="tab-pane fade" id="interests">
          <div class="card shadow-sm border-0 animate__animated animate__fadeInUp">
            <div class="card-body p-4">
              <h5 class="card-title mb-4">
                <i class="fas fa-heart me-2 text-primary"></i>Your Interests
              </h5>

              <div class="mb-4">
                <label for="interests" class="form-label">Interests</label>
                <textarea class="form-control" id="interests" rows="3" [(ngModel)]="member.interests" name="interests"
                  placeholder="Enter your interests separated by commas (e.g., reading, hiking, music)"></textarea>
                <div class="form-text">Separate multiple interests with commas</div>
              </div>

              <div class="interests-preview" *ngIf="member.interests">
                <h6 class="mb-3">Preview:</h6>
                <div class="interests-container">
                  <span *ngFor="let interest of member.interests.split(',')"
                    class="badge bg-light text-dark me-2 mb-2 p-2">
                    {{ interest.trim() }}
                  </span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="tab-pane fade" id="photos">
          <app-photo-editor
          [member]="member"
          (memberChange)="onMemberChange($event)">
        </app-photo-editor>
        </div>
      </div>
      <div class="fixed-save-section" *ngIf="activeTab !== 'photos'">
        <div class="container">
          <div class="d-flex justify-content-end gap-2">
            <button type="button" class="btn btn-outline-secondary">
              <i class="fas fa-times me-2"></i>Cancel
            </button>
            <button type="submit" class="btn btn-primary" [disabled]="editForm.invalid || editForm.pristine">
              <i class="fas fa-save me-2"></i>Save Changes
            </button>
          </div>
        </div>
      </div>
    </form>
  </div>
</div>
